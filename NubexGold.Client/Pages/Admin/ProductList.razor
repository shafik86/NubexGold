@page "/productList"

@using System.Net.Http.Json

@inject HttpClient httpClient


<PageTitle>@Pagetitle</PageTitle>
        @*<EditForm Model="@ProductModel" OnValidSubmit="OnValidSubmit">

                </EditForm>*@
    <MudTable Items="@Products" Dense="@dense" Hover="@hover" ReadOnly="@ronly" CanCancelEdit="@canCancelEdit" Filter="new Func<Product,bool>(FilterFunc)"
              @bind-SelectedItem="selectedItem1" SortLabel="Sort By" CommitEditTooltip="Commit Edit"
              OnCommitEditClick="@(() => Snackbar.Add("Commit Edit Handler Invoked"))" RowEditPreview="BackupItem" RowEditCancel="ResetItemToOriginalValues"
              RowEditCommit="ItemHasBeenCommitted" IsEditRowSwitchingBlocked="@blockSwitch">
        <ToolBarContent>
            <MudText Typo="Typo.h4">All List Product</MudText>
            <MudSpacer />
            <MudTextField @bind-Value="searchString" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
        </ToolBarContent>
        <ColGroup>
            <col style="width:50px;" />
            <col style="width:80px;" />
            <col style="width:20%;" />
            <col />
            <col />
            <col style="width:20%;" />
        </ColGroup>
        <HeaderContent>
            <MudTh><MudTableSortLabel SortBy="new Func<Product, object>(x=>x.SKU)">SKU</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<Product, object>(x=>x.Name)">Name</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<Product, object>(x=>x.Metal)">Metal</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<Product, object>(x=>x.Weight)">Weight</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<Product, object>(x=>x.Price)">From (MYR)</MudTableSortLabel></MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Nr">@context.SKU</MudTd>
            <MudTd DataLabel="Name">@context.Name</MudTd>
            <MudTd DataLabel="Sign">@context.Metal</MudTd>
            <MudTd DataLabel="Position">@context.Weight</MudTd>
            <MudTd DataLabel="Molar mass">@context.Price</MudTd>
        </RowTemplate>
        <RowEditingTemplate>
            <MudTd DataLabel="Nr">@context.SKU</MudTd>
            <MudTd DataLabel="Name">
                <MudTextField @bind-Value="@context.Name" Required />
            </MudTd>
            <MudTd DataLabel="Sign">
                <MudTextField @bind-Value="@context.Metal" Required />
            </MudTd>
            <MudTd DataLabel="Position">
                <MudNumericField @bind-Value="@context.Weight" Required Min="1" />
            </MudTd>
            <MudTd DataLabel="Molar mass">
                <MudTextField @bind-Value="@context.Price" Required />
            </MudTd>
        </RowEditingTemplate>
        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>

    <MudSwitch @bind-Checked="@hover" Color="Color.Primary">Hover</MudSwitch>
    <MudSwitch @bind-Checked="@dense" Color="Color.Secondary">Dense</MudSwitch>
    <MudSwitch @bind-Checked="@ronly" Color="Color.Tertiary">Read Only</MudSwitch>
    <MudSwitch @bind-Checked="@canCancelEdit" Color="Color.Info">Can Cancel Edit</MudSwitch>
    <MudSwitch @bind-Checked="@blockSwitch" Color="Color.Success">Block Edit Row Switching</MudSwitch>
    <MudText Inline="true">Selected1: @selectedItem1?.Name</MudText>

    <MudExpansionPanels Style="flex: 1;">
        <MudExpansionPanel Text="Show inline-edit event log">
            @foreach (var message in editEvents)
            {
    <MudText>@message</MudText>}
            @if (editEvents.Count > 0)
            {
    <div class="d-flex">
        <MudSpacer />
        <MudButton Class="mt-3" ButtonType="ButtonType.Button" Variant="Variant.Filled" OnClick="ClearEventLog">Clear event log</MudButton>
    </div>}
        </MudExpansionPanel>
    </MudExpansionPanels>



